"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = deepKill;

var _psTree = _interopRequireDefault(require("ps-tree"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

async function deepKill(pid, signal = "SIGKILL") {
  await new Promise((resolve, reject) => {
    (0, _psTree.default)(pid, (err, children) => {
      if (err) {
        return reject(err);
      }

      try {
        process.kill(pid, signal);
      } catch (e) {
        return reject(e);
      }

      for (const tpid of children.map(({
        PID
      }) => Number.parseInt(PID, 10))) {
        try {
          process.kill(tpid, signal);
        } catch (e) {
          return reject(e);
        }
      }

      resolve();
    });
  });
}

module.exports = exports.default;